jQuery(t=>{let e=t("#creditSimulation"),d=t(".installment-table"),n=d.find("tbody"),r=d.find("tfoot"),a=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}),o=()=>{t(".result-container p span").empty().parents(".result-container").css("display","none"),n.empty(),r.find("th:not(:first-child)").html("&nbsp;")},l=(e,d,o)=>{let l=(1+d)**o,f=e*d*(l/(l-1));t("#textInstallment").text(a.format(f));let i,m,c,s,h=0,p=0,$=e;for(i=0;i<o;i++)p+=c=d*$,h+=m=f-c,$-=m,$=$<=0?0:$,s="",s+=`<tr><th scope="row">${i+1}</th>`,s+=`<td>${a.format(m)}</td>`,s+=`<td>${a.format(c)}</td>`,s+=`<td>${a.format(f)}</td>`,s+=`<td>${a.format($)}</td></tr>`,n.append(s);r.find(":nth-child(2)").text(a.format(h)),r.find(":nth-child(3)").text(a.format(p)),r.find(":nth-child(4)").text(a.format(f*o))},f=(e,d,o)=>{let l=e/o,f=e*d,i=l+f;t("#textInstallment").text(a.format(i));let m,c,s=0,h=0,p=e;for(m=0;m<o;m++)p-=l,p=p<=0?0:p,s+=l,h+=f,c="",c+=`<tr><th scope="row">${m+1}</th>`,c+=`<td>${a.format(l)}</td>`,c+=`<td>${a.format(f)}</td>`,c+=`<td>${a.format(i)}</td>`,c+=`<td>${a.format(p)}</td></tr>`,n.append(c);r.find(":nth-child(2)").text(a.format(s)),r.find(":nth-child(3)").text(a.format(h)),r.find(":nth-child(4)").text(a.format(i*o))},i=(e,d,o)=>{let l=e/o;t("#textInstallment").text("Lihat tabel");let f,i,m,c,s=0,h=0,p=0,$=e;for(f=0;f<o;f++)p+=m=(i=(e-f*l)*d)+l,$-=l,$=$<=0?0:$,s+=l,h+=i,c="",c+=`<tr><th scope="row">${f+1}</th>`,c+=`<td>${a.format(l)}</td>`,c+=`<td>${a.format(i)}</td>`,c+=`<td>${a.format(m)}</td>`,c+=`<td>${a.format($)}</td></tr>`,n.append(c);r.find(":nth-child(2)").text(a.format(s)),r.find(":nth-child(3)").text(a.format(h)),r.find(":nth-child(4)").text(a.format(p))};e.on("click","#csCount",e=>{o();let d=Number(t("#csAmount").val()),r=Number(t("#csInterest").val())/12/100,m=Number(t("#csPeriod").val()),c=t("#csType").val();t("#textPeriod").text(`${m} bulan`),t("#textAmount").text(a.format(d));let s='<tr><th scope="row">0</th><td>0</td><td>0</td>';if(s+=`<td>0</td><td>${a.format(d)}</td></tr>`,n.append(s),"annuity"===c)l(d,r,m);else if("flat"===c)f(d,r,m);else{if("effective"!==c)return;i(d,r,m)}t(".result-container").css("display","")}),e.on("reset",t=>{o()}),e.on("input",'[type="text"]',function(e){let d=t(this),n=d.val();d.val(n.replace(/[^0-9.,]/,""))})});
